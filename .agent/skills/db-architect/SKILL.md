---
name: db-architect
description: ベクトルDB(SQLite)およびセッションDBのスキーマとER図の整合性管理を行うスキル
---

# db-architect Skill

データベースのスキーマ管理、データの移行（マイグレーション）、および構成図の同期を担当します。

## 構成
- 入力: 新機能のデータ要件、既存のDB定義（`vector_store.db` スキーマ等）
- 出力: スキーマ変更スクリプト、更新されたER図（Mermaid記法）

## 手順
1. **現状分析**: `sqlite3` 等を使用して、現在のテーブル構造とインデックスを確認する。
2. **スキーマ設計**:
    - 要件に基づき、新しいテーブルやカラムの定義案を作成する。
    - 命名規則（スネークケース等）およびデータ型（TEXT, BLOB, JSON等）を最適化する。
3. **マイグレーション実行**:
    - 既存データを壊さないよう、`ALTER TABLE` 等のスクリプトを生成し実行する。
    - 埋め込みベクトルの次元数など、AI特有の設定値を管理する。
4. **ドキュメント更新**: 変更内容を反映したER図を Mermaid 形式で生成し、設計ドキュメントを更新する。

## 判断基準
- スキーマ変更がアプリケーションコード（DAO等）に与える影響を特定する。
- ベクトルデータベースの場合、インデックス（HNSW, Flat等）の再構築が必要か判断する。

## 実行例
「新しいセクションの状態を保存したい」
→ `db-architect` が起動
→ `sections_status` テーブルの構造を確認
→ スキーマ変更案を提示し、SQLを実行
